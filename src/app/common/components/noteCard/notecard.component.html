
<ng-container #main [ngTemplateOutlet]="viewTemplate" style="width: 100%"></ng-container>


<ng-template #loadingView>
  Loading...
</ng-template>

<ng-template #cardView>
  <ion-card style="width: 100%; height: 100%">
    <ion-card-header>
      <ion-card-title>
        <ion-item lines="none" [button]="true" (click)="openNote()">
          <strong [ngClass]="{'inactive-note': !note.active}">{{ note.name }}</strong>
        </ion-item>
      </ion-card-title>
      <ng-container *ngIf="isNoteSharedWithMe">
        <ion-note color="secondary">
          (<strong>{{note.creatorUsername}}</strong> <em> shared this. </em>) <!-- TODO: Add other share method messages -->
        </ion-note>
      </ng-container>
    </ion-card-header>

    <ion-card-content *ngIf="noteParts !== null">
      <app-notetext-block [note]="note"></app-notetext-block>
    </ion-card-content>
  </ion-card>

  <!-- Popover -->
  <ion-popover [trigger]="'card-shared-with-' + note.id" triggerAction="click">
    <ng-template>
      <ion-content class="ion-padding">
        <!-- Show who shared the note with you -->
        {{note.rawText}}
      </ion-content>
    </ng-template>
  </ion-popover>
</ng-template>


<ng-template #rowView>
  <ion-item style="width: 100%" [button]="true" (click)="openNote()">
    <ion-label [ngClass]="{'inactive-note': !note.active}">
      {{ note.name }}
    </ion-label>

    <ion-note style="align-self: center;" class="note-updated">
      {{ note.updated | date: 'short' }}
    </ion-note>

    <ng-container *ngIf="isNoteSharedWithMe; else shareNote">
      <ion-button [id]="'shared-with-' + note.id" slot="end" color="secondary" size="small" (click)="$event.stopPropagation()">
        <ion-icon slot="icon-only" name="people-outline"></ion-icon>
      </ion-button>
        <!-- Popover -->
      <ion-popover [trigger]="'shared-with-' + note.id" triggerAction="click">
        <ng-template>
          <ion-content class="ion-padding">
            <!-- Show who shared the note with you -->
            Shared by: {{note.creatorUsername}}
          </ion-content>
        </ng-template>
      </ion-popover>
    </ng-container>

    <ng-template #shareNote>
      <!-- For now they have to view the note to share -->

      <!-- <ion-button [id]="'share-with-' + note.id" slot="end" color="primary" size="small" (click)="$event.stopPropagation()">
        <ion-icon slot="icon-only" name="share-outline"></ion-icon>
      </ion-button>

      <ion-popover [trigger]="'share-with-' + note.id" triggerAction="click">
        <ng-template>
          <ion-content class="ion-padding">
            Share note with players:
            <ion-select>

            </ion-select>
          </ion-content>
        </ng-template>
      </ion-popover> -->
    </ng-template>

  </ion-item>
</ng-template>
