<ion-content>
  <ion-card>
    <ion-card-content>
      <app-table [data]="characters"
                [columns]="cols"
                [actions]="getTableActions()"
                [primaryColumn]="'username'"
                [editable]="false"
                (valueChange)="saveChanges($event)">
      </app-table>
    </ion-card-content>

    <br />

    <ion-button [routerLink]="['-1']" fill="outline" color="primary">
      <ion-icon slot="start" name="add-circle-outline"></ion-icon>
      <ion-label>Add Character</ion-label>
    </ion-button>

    <ion-button [routerLink]="['-1']" fill="outline" color="primary">
      <ion-icon slot="start" name="add-circle-outline"></ion-icon>
      <ion-label>Attach to User</ion-label>
    </ion-button>


  </ion-card>
</ion-content>

<ion-modal #attachToUser>
  <ng-template>
    <ion-card>
      <ion-card-header>
        <ion-card-title>Viewing {{characters[contextIndex].name}}</ion-card-title>
        <ion-card-subtitle>Edit and confirm changes</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item>
            <ion-label>
              <h2>Before</h2>
                {{characters[contextIndex].userId ?? 'No User'}}
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label>
              <h2>After</h2>
            </ion-label>
            <ion-select [(ngModel)]="changedUserIdForCharacter"
                        [value]="changedUserIdForCharacter"
                        >
              <ion-select-option *ngFor="let option of users" [value]="option.id" >
                {{ option.username }}
              </ion-select-option>
            </ion-select>
          </ion-item>
        </ion-list>
        <ion-button fill="outline" color="primary" (click)="saveAttachModal()">Confirm</ion-button>
        <ion-button fill="outline" color="secondary" (click)="cancelAttachModal()">Cancel</ion-button>
      </ion-card-content>
    </ion-card>
  </ng-template>
</ion-modal>
